<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="format-detection" content="telephone=no">
    <title>报名课程</title>
    <link rel="stylesheet" href="../css/frozen.css">
    <link rel="stylesheet" href="../css/public.css">
    <script src="../lib/zepto.min.js"></script>
    <script src="../js/frozen.js"></script>
    <script type="text/javascript" src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
    <style type="text/css">
    .ui-lesson-header img {display: block;height: 200px;width: 100%;}
    .ui-lesson-header .ui-lesson-headerIntro {text-align: center;background-color: #fff;padding: 10px 0;}
    .ui-lesson-header h3 {font-size: 14px;margin: 10px 0;}
    .ui-lesson-header h3 span {margin: 0 5px;}
    .demo-item #desc{color: #a2a2a2;font-size: 12px;margin: 10px;}
    .item-details {background: #fff;margin: 10px 0;padding-bottom: 10px;}
    .item-details img {width: 96%;margin: 10px auto;display: block;}
    .item-details .demo-desc {color: #555;font-size: 14px;}
    .item-details .demo-desc span {margin-right: 10px;color: #000;font-weight: bold;font-size: 14px;}
    .item-text {background-color: #fff;padding-bottom: 40px;overflow:hidden;}
    .item-text .ui-btn-lg {width: 100px;margin: 20px auto 0;}
    .ui-form-item label:not(.ui-switch):not(.ui-checkbox):not(.ui-checkbox-s):not(.ui-radio){width: 80px;}
    .ui-sign-lesson .ui-dialog-cnt{width: 80%;}
    .ui-sign-lesson .ui-dialog-hd{background-color: #fff; margin-bottom: 10px;border-radius:5px;-webkit-border-radius:5px;}
    .ui-sign-lesson .ui-dialog-hd h3{font-weight: 600;font-size: 14px;color: #3d3d3d;background-color:#fff;border-radius:5px;-webkit-border-radius:5px;}
    .ui-sign-lesson .ui-form label{color: #424242;}
    .ui-sign-lesson .but-wrap {text-align: center;background-color: #fff;padding: 20px 0;border-radius: 5px;-webkit-border-radius:5px;}
    .ui-sign-lesson .but-wrap label{color: #7e7e7e;font-size:12px;}
    .ui-sign-lesson .but-wrap .ui-btn-primary{width: 150px;font-size:12px;margin: 20px auto 10px;height: 35px;line-height: 35px;}
    .ui-form-item label,.ui-form-item input,.ui-form-item span,.ui-form-item select{font-size:12px;}
    .ui-form-item select option{list-style:none;}
    .ui-user-city input{width:70px;text-align: center;padding:0}
    </style>
</head>

<body ontouchstart>
    <section class="ui-container">
        <div class="demo-block ui-lesson-header">
            <img id="image" src="http://placeholder.qiniudn.com/640x200" />
            <div class="ui-lesson-headerIntro">
                <h3><span>——</span><span id="name"></span><span>——</span></h3>
                <p >主讲人:<span id="teacher"></span></p>
                <p>时间:<span id="startTime"></span>-<span id="endTime"></span></p>
                <p>地点:<span id="address"></span></p>
            </div>
        </div>
        <div class="demo-item item-details">
            <p class="demo-desc"><span>|</span>课程详情</p>
            <img id="thumbnail" src="../img/detail_ad0.png">
        </div>
        <div class="demo-item item-text">
            <div id="desc"></div>
            <button class="ui-btn-lg ui-btn-primary" id="btn1">立即参加</button>
        </div>

        <div class="demo-block ui-sign-lesson">
            <div class="ui-dialog">
                <div class="ui-dialog-cnt">
                    <header class="ui-dialog-hd">
                        <h3>完善您的报名信息</h3>
                        <i class="ui-dialog-close" data-role="button"></i>
                    </header>
                    <div class="demo-block">
                        <div class="ui-form ui-border-t">
                            <form action="#">
                                <div class="ui-form-item ui-border-b">
                                    <label class="ui-border-r">姓名：</label>
                                    <input type="text" id="realname" class="ui-toWd" placeholder="输入您的姓名" />
                                </div>
                                <div class="ui-form-item ui-border-b">
                                    <label class="ui-border-r"> 性别：</label>
                                    <input type="text" id="sex" class="ui-toWd" placeholder="输入您的性别" />
                                </div>
                                <div class="ui-form-item ui-border-b">
                                    <label class="ui-border-r">职业：</label>
                                    <div class="ui-select">
			                            <select>
			                                <option>计算机/互联网/通信/电子</option>
			                                <option selected="">销售/客服/技术支持</option>
			                                <option>会计/金融/银行/保险</option>
			                                <option>生产/营运/采购/物流</option>
			                                <option>生物/制药/医疗/护理</option>
			                                <option>广告/市场/媒体/艺术</option>
			                                <option>建筑/房地产</option>
			                                <option>人事/行政/高级管理</option>
			                                <option>咨询/法律/教育/科研</option>
			                                <option>服务业</option>
			                                <option>公务员/翻译</option>
			                                <option>其他</option>
			                            </select>
			                        </div>
                                </div>
                                 <div class="ui-form-item ui-border-b">
                                    <label class="ui-border-r">工作年限：</label>
                                    <div class="ui-select">
			                            <select>
			                                <option>学生</option>
			                                <option selected="">1~3年</option>
			                                <option>3~5年</option>
			                                <option>5~10年</option>
			                                <option>10年以上</option>
			                            </select>
			                        </div>
                                </div>
                                <div class="ui-form-item ui-border-b">
                                    <label class="ui-border-r">手机号：</label>
                                    <input type="text" id="mobile" class="ui-thWd" placeholder="输入您的手机号" />
                                </div>
                                <div class="ui-form-item ui-border-b">
                                    <label class="ui-border-r">微信号：</label>
                                    <input type="text" id="weixin" class="ui-thWd" placeholder="输入您的微信号" />
                                </div>
                                <div class="ui-form-item ui-border-b ui-user-city">
			                        <span> 城市：</span>
			                        <input type="text" id="province" class="ui-huWd">
			                         <span>省</span>
			                        <input type="text" id="city" class="ui-eiWd">
			                         <span> 市</span>
			                    </div>
                            </form>
                        </div>
                    </div>
                    <div class="but-wrap">
                        <div class="ui-btn-small">
                           <label class="ui-checkbox-s">
                                <input type="radio" name="online" value="1" checked>线上
                            </label>
                            <label class="ui-checkbox-s">
                                <input type="radio" name="online" value="2">线下
                            </label>
                        </div>
                        <button class="ui-btn-lg ui-btn-primary" id="btn-submit">提交</button>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- /.ui-container-->
    <script>
    $('.ui-list li,.ui-tiled li').click(function() {
        if ($(this).data('href')) {
            location.href = $(this).data('href');
        }
    });
	//TODO 
    Zepto(function($) {
    	
    	BWK.api.lesson.lessonDetail(BWK.UrlParams.id,function(data){
            var dealObj = data||{};
            $('#name').text(dealObj.name);
            $('#teacher').text(dealObj.teacher);
            $('#startTime').text(BWK.Utils.dateformateLocal(new Date(dealObj.startTime),"yyyy-MM-dd hh:mm"));
            $('#endTime').text(BWK.Utils.dateformateLocal(new Date(dealObj.endTime),"yyyy-MM-dd hh:mm"));
            $('#address').text(dealObj.address);
            $('#image').attr('src',dealObj.image);
            $('#thumbnail').attr('src',dealObj.thumbnail);
            $('#desc').html(dealObj.desc);
           
        }); 
    	//分享文字
    	BWK.api.lesson.shareText(null,function(data){
           var shareObj = {lessonName:data.name,desc:data.value,shareUrl:location.href};
           BWK.WeixinShare(shareObj); 
        }); 
        
    	$("#btn1").click(function(){
            $(".ui-dialog").dialog("show");
        })
        $('#btn-submit').click(function(){
            
            //报名
            var params  = [];
            $('form input').each(function(){
                if($(this).val()){
                    params.push({"name":$(this).attr('id'),"value":$(this).val()});
                }
            });

            BWK.api.user.updateUser(params,function(data){
                var online = $('input[type="radio"]:checked').val()==1?true:false; 

                BWK.api.lesson.lessonSign({"lessonId":BWK.UrlParams.id,"online":online},function(data){
                    $(".ui-dialog").dialog("hide"); 
                    BWK.Utils.Tips('已报名成功！');
                });
            });

        })
        //查询个人信息
        BWK.api.user.getUser(null,function(data){
        	for(var i in data){
        		$('#'+i).val(data[i]);
        	}
        });
        


    });

    function _dealImgList(obj) {



    }
    </script>
</body>

</html>
